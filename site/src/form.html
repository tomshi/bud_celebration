<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, width=device-width, user-scalable=yes, minimal-ui">
    <title>百威庆祝</title>

    <!-- build:css css/main.css -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="bower_components/cropper/dist/cropper.min.css">
    <!-- endbuild -->

    <!-- build:js js/vendor.js -->
    <script src="bower_components/modernizr/modernizr.js"></script>
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <!-- endbuild -->

    <meta name="renderer" content="webkit">
    <meta name="google" value="notranslate">
</head>
<body>

    <div id="wrapper">

        <section id="stage">
            <div class="frame" id="form" style="display: block;">
                <div class="header">
                    <div class="text1"><img src="img/form-text1.png" class="responsive" alt=""/></div>
                    <div class="headline"><img src="img/form-headline.png" class="responsive" alt=""/></div>
                    <div class="text2"><img src="img/form-text2.png" class="responsive" alt=""/></div>
                </div>
                <div class="form">
                    <div class="input name">
                        <input type="text" class="name" name="username" placeholder="为谁欢庆" value=""/>
                    </div>
                    <div class="input type">
                        <input type="text" class="type" name="type" placeholder="庆祝什么" value=""/>
                        <ul class="type-list">
                            <li>生曰快乐</li>
                            <li>新年快乐</li>
                        </ul>
                    </div>
                    <div class="input time">
                        <input type="text" class="time" name="time" placeholder="在哪一天" value=""/>
                    </div>
                    <a href="##" class="submit"></a>
                    <div class="upload">
                        <input type="file" class="file" name="files" id="fileupload_input" />
                        <div class="text">+ 上传一张照片，获得更专属的体验</div>
                    </div>
                </div>
            </div>
        </section>
        <div id="hand"><img src="img/hand.png"></div>

    </div>

    <section class="overlay">
        <div class="crop">
            <img id="uploadImgHolder" src="" alt=""/>
        </div>
    </section>

    <!-- build:js js/plugins.js -->
    <script src="bower_components/velocity/velocity.min.js"></script>
    <script src="bower_components/letteringjs/jquery.lettering.js"></script>
    <script src="bower_components/cropper/dist/cropper.min.js"></script>


    <script src="bower_components/jquery-file-upload/js/vendor/jquery.ui.widget.js"></script>
    <script src="bower_components/jquery-file-upload/js/jquery.iframe-transport.js"></script>
    <script src="bower_components/jquery-file-upload/js/jquery.fileupload.js"></script>
    <!-- endbuild -->

    <!-- build:js js/main.js -->
    <script src="js/preload.js"></script>
    <script src="js/main.js"></script>
    <script src="js/bottle.js"></script>
    <script src="js/toy.js"></script>
    <!-- endbuild -->

    <script type="text/javascript">
        $(".input input").bind("focus", function(){
            var $this = $(this);
            var name = $this.attr("name");
            if (name == "type"){
                $(".type-list").slideDown();
            }else if (name == "time") {
                $this.attr("placeholder", "日日/月月");
            }else {}
            $this.parent().addClass("focus");
        }).bind("blur", function(){
            $(this).parent().removeClass("focus");
            $(".time").attr("placeholder", "在哪一天");
            $(".type-list").slideUp();
        }).bind("change", function(){
            console.log($(this).val());
        }).bind("keyup", function(){
            console.log($(this).val());
        });

        $(".type-list li").bind("click", function(){
            var val = $(this).text();
            $(".type").val(val);
            $(".type-list").slideUp();
        });


        var holder = $("#uploadImgHolder");
        function initCropImg(src){
            holder.attr("src", src);
            $(".overlay").show();
            $(".crop > img").cropper({
                aspectRatio: 1.777,
                width: 500,
                done: function(data) {
                    // Crop image with the result data.
                    console.log(data.x);
                    console.log(data.y);
                    console.log(data.height);
                    console.log(data.width);
                }
            });
        }
        $(function(){
            $("#fileupload_input").fileupload({
                url:"api/upload.json",//文件上传地址，当然也可以直接写在input的data-url属性内
                formData:{param1:"p1",param2:"p2"},//如果需要额外添加参数可以在这里添加
                done:function(e,result){
                    //done方法就是上传完毕的回调函数，其他回调函数可以自行查看api
                    //注意result要和jquery的ajax的data参数区分，这个对象包含了整个请求信息
                    //返回的数据在result.result中，假设我们服务器返回了一个json对象
                    console.log(JSON.stringify(result.result));
                    initCropImg();
                }
            });
        });
    </script>

</body>
</html>